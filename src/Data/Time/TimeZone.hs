{-# OPTIONS_GHC -fno-warn-type-defaults #-}

module Data.Time.TimeZone where

import Control.Applicative
import Control.Arrow (second)
import Data.IntMap (IntMap)
import qualified Data.IntMap as IntMap (empty,insertWith,lookup)
import Data.Time
import Data.Time.Clock.POSIX
import Data.Time.LocalTime.TimeZone.Series

-----------------------------------------------------------------------------

timeZoneSeries :: Int -> Maybe TimeZoneSeries
timeZoneSeries tz = do
  tzs <- IntMap.lookup tz timeZoneSeriesMap
  tzd <- if null tzs then Nothing else Just (snd $ head tzs)
  return $ TimeZoneSeries tzd tzs 

timeZoneSeriesMap :: IntMap [(UTCTime, TimeZone)]
timeZoneSeriesMap = reverse <$> foldr addZoneTime IntMap.empty zonetime 
  where
  addZoneTime [i,c,t,o,d] = IntMap.insertWith (++) (read i) [(strSecsToUTCTime t, timeZone o d c)]
  addZoneTime _ = id
  strSecsToUTCTime = posixSecondsToUTCTime . realToFrac . read
  strSecsToMinutes = (`div` 60) . read
  strIntToBool = toEnum . read
  timeZone sOffset sDST = TimeZone (strSecsToMinutes sOffset) (strIntToBool sDST)


demo :: IO ()
demo = do
  u <- getCurrentTime
  z <- getCurrentTimeZone 
  let l = utcToLocalTime z u
  print $ maybe "Error" (show . flip utcToLocalTime' u) $ timeZoneSeries 36 
  print $ maybe "Error" (show . flip localTimeToUTC' l) $ timeZoneSeries 36 
  print $ maybe "Error" (show . tzToTuple . flip timeZoneFromSeries u) $ timeZoneSeries 36 
  print $ maybe "Error" (show . map (second tzToTuple)) $ tzsTransitions <$> timeZoneSeries 36
  putStrLn ""
  print $ maybe "Error" (show . flip utcToLocalTime' u) $ timeZoneSeries 39
  print $ maybe "Error" (show . flip localTimeToUTC' l) $ timeZoneSeries 39 
  print $ maybe "Error" (show . tzToTuple . flip timeZoneFromSeries u) $ timeZoneSeries 39 
  print $ maybe "Error" (show . map (second tzToTuple)) $ tzsTransitions <$> timeZoneSeries 39

tzToTuple :: TimeZone -> (Int, Bool, String)
tzToTuple (TimeZone o d n) = (o,d,n)

-----------------------------------------------------------------------------
-- Data (sources from: http://timezonedb.com/download)
-- Note: only Aus (Victoria) in zometime

country :: [[String]]
country = 
  [["AD","Andorra"]
  ,["AE","United Arab Emirates"]
  ,["AF","Afghanistan"]
  ,["AG","Antigua and Barbuda"]
  ,["AI","Anguilla"]
  ,["AL","Albania"]
  ,["AM","Armenia"]
  ,["AN","Netherlands Antilles"]
  ,["AO","Angola"]
  ,["AQ","Antarctica"]
  ,["AR","Argentina"]
  ,["AS","American Samoa"]
  ,["AT","Austria"]
  ,["AU","Australia"]
  ,["AW","Aruba"]
  ,["AX","Aland Islands"]
  ,["AZ","Azerbaijan"]
  ,["BA","Bosnia and Herzegovina"]
  ,["BB","Barbados"]
  ,["BD","Bangladesh"]
  ,["BE","Belgium"]
  ,["BF","Burkina Faso"]
  ,["BG","Bulgaria"]
  ,["BH","Bahrain"]
  ,["BI","Burundi"]
  ,["BJ","Benin"]
  ,["BL","Saint Barthélemy"]
  ,["BM","Bermuda"]
  ,["BN","Brunei"]
  ,["BO","Bolivia"]
  ,["BQ","Bonaire, Saint Eustatius and Saba "]
  ,["BR","Brazil"]
  ,["BS","Bahamas"]
  ,["BT","Bhutan"]
  ,["BV","Bouvet Island"]
  ,["BW","Botswana"]
  ,["BY","Belarus"]
  ,["BZ","Belize"]
  ,["CA","Canada"]
  ,["CC","Cocos Islands"]
  ,["CD","Democratic Republic of the Congo"]
  ,["CF","Central African Republic"]
  ,["CG","Republic of the Congo"]
  ,["CH","Switzerland"]
  ,["CI","Ivory Coast"]
  ,["CK","Cook Islands"]
  ,["CL","Chile"]
  ,["CM","Cameroon"]
  ,["CN","China"]
  ,["CO","Colombia"]
  ,["CR","Costa Rica"]
  ,["CS","Serbia and Montenegro"]
  ,["CU","Cuba"]
  ,["CV","Cape Verde"]
  ,["CW","Curaçao"]
  ,["CX","Christmas Island"]
  ,["CY","Cyprus"]
  ,["CZ","Czech Republic"]
  ,["DE","Germany"]
  ,["DJ","Djibouti"]
  ,["DK","Denmark"]
  ,["DM","Dominica"]
  ,["DO","Dominican Republic"]
  ,["DZ","Algeria"]
  ,["EC","Ecuador"]
  ,["EE","Estonia"]
  ,["EG","Egypt"]
  ,["EH","Western Sahara"]
  ,["ER","Eritrea"]
  ,["ES","Spain"]
  ,["ET","Ethiopia"]
  ,["FI","Finland"]
  ,["FJ","Fiji"]
  ,["FK","Falkland Islands"]
  ,["FM","Micronesia"]
  ,["FO","Faroe Islands"]
  ,["FR","France"]
  ,["GA","Gabon"]
  ,["GB","United Kingdom"]
  ,["GD","Grenada"]
  ,["GE","Georgia"]
  ,["GF","French Guiana"]
  ,["GG","Guernsey"]
  ,["GH","Ghana"]
  ,["GI","Gibraltar"]
  ,["GL","Greenland"]
  ,["GM","Gambia"]
  ,["GN","Guinea"]
  ,["GP","Guadeloupe"]
  ,["GQ","Equatorial Guinea"]
  ,["GR","Greece"]
  ,["GS","South Georgia and the South Sandwich Islands"]
  ,["GT","Guatemala"]
  ,["GU","Guam"]
  ,["GW","Guinea-Bissau"]
  ,["GY","Guyana"]
  ,["HK","Hong Kong"]
  ,["HM","Heard Island and McDonald Islands"]
  ,["HN","Honduras"]
  ,["HR","Croatia"]
  ,["HT","Haiti"]
  ,["HU","Hungary"]
  ,["ID","Indonesia"]
  ,["IE","Ireland"]
  ,["IL","Israel"]
  ,["IM","Isle of Man"]
  ,["IN","India"]
  ,["IO","British Indian Ocean Territory"]
  ,["IQ","Iraq"]
  ,["IR","Iran"]
  ,["IS","Iceland"]
  ,["IT","Italy"]
  ,["JE","Jersey"]
  ,["JM","Jamaica"]
  ,["JO","Jordan"]
  ,["JP","Japan"]
  ,["KE","Kenya"]
  ,["KG","Kyrgyzstan"]
  ,["KH","Cambodia"]
  ,["KI","Kiribati"]
  ,["KM","Comoros"]
  ,["KN","Saint Kitts and Nevis"]
  ,["KP","North Korea"]
  ,["KR","South Korea"]
  ,["KW","Kuwait"]
  ,["KY","Cayman Islands"]
  ,["KZ","Kazakhstan"]
  ,["LA","Laos"]
  ,["LB","Lebanon"]
  ,["LC","Saint Lucia"]
  ,["LI","Liechtenstein"]
  ,["LK","Sri Lanka"]
  ,["LR","Liberia"]
  ,["LS","Lesotho"]
  ,["LT","Lithuania"]
  ,["LU","Luxembourg"]
  ,["LV","Latvia"]
  ,["LY","Libya"]
  ,["MA","Morocco"]
  ,["MC","Monaco"]
  ,["MD","Moldova"]
  ,["ME","Montenegro"]
  ,["MF","Saint Martin"]
  ,["MG","Madagascar"]
  ,["MH","Marshall Islands"]
  ,["MK","Macedonia"]
  ,["ML","Mali"]
  ,["MM","Myanmar"]
  ,["MN","Mongolia"]
  ,["MO","Macao"]
  ,["MP","Northern Mariana Islands"]
  ,["MQ","Martinique"]
  ,["MR","Mauritania"]
  ,["MS","Montserrat"]
  ,["MT","Malta"]
  ,["MU","Mauritius"]
  ,["MV","Maldives"]
  ,["MW","Malawi"]
  ,["MX","Mexico"]
  ,["MY","Malaysia"]
  ,["MZ","Mozambique"]
  ,["NA","Namibia"]
  ,["NC","New Caledonia"]
  ,["NE","Niger"]
  ,["NF","Norfolk Island"]
  ,["NG","Nigeria"]
  ,["NI","Nicaragua"]
  ,["NL","Netherlands"]
  ,["NO","Norway"]
  ,["NP","Nepal"]
  ,["NR","Nauru"]
  ,["NU","Niue"]
  ,["NZ","New Zealand"]
  ,["OM","Oman"]
  ,["PA","Panama"]
  ,["PE","Peru"]
  ,["PF","French Polynesia"]
  ,["PG","Papua New Guinea"]
  ,["PH","Philippines"]
  ,["PK","Pakistan"]
  ,["PL","Poland"]
  ,["PM","Saint Pierre and Miquelon"]
  ,["PN","Pitcairn"]
  ,["PR","Puerto Rico"]
  ,["PS","Palestinian Territory"]
  ,["PT","Portugal"]
  ,["PW","Palau"]
  ,["PY","Paraguay"]
  ,["QA","Qatar"]
  ,["RE","Reunion"]
  ,["RO","Romania"]
  ,["RS","Serbia"]
  ,["RU","Russia"]
  ,["RW","Rwanda"]
  ,["SA","Saudi Arabia"]
  ,["SB","Solomon Islands"]
  ,["SC","Seychelles"]
  ,["SD","Sudan"]
  ,["SE","Sweden"]
  ,["SG","Singapore"]
  ,["SH","Saint Helena"]
  ,["SI","Slovenia"]
  ,["SJ","Svalbard and Jan Mayen"]
  ,["SK","Slovakia"]
  ,["SL","Sierra Leone"]
  ,["SM","San Marino"]
  ,["SN","Senegal"]
  ,["SO","Somalia"]
  ,["SR","Suriname"]
  ,["SS","South Sudan"]
  ,["ST","Sao Tome and Principe"]
  ,["SV","El Salvador"]
  ,["SX","Sint Maarten"]
  ,["SY","Syria"]
  ,["SZ","Swaziland"]
  ,["TC","Turks and Caicos Islands"]
  ,["TD","Chad"]
  ,["TF","French Southern Territories"]
  ,["TG","Togo"]
  ,["TH","Thailand"]
  ,["TJ","Tajikistan"]
  ,["TK","Tokelau"]
  ,["TL","East Timor"]
  ,["TM","Turkmenistan"]
  ,["TN","Tunisia"]
  ,["TO","Tonga"]
  ,["TR","Turkey"]
  ,["TT","Trinidad and Tobago"]
  ,["TV","Tuvalu"]
  ,["TW","Taiwan"]
  ,["TZ","Tanzania"]
  ,["UA","Ukraine"]
  ,["UG","Uganda"]
  ,["UM","United States Minor Outlying Islands"]
  ,["US","United States"]
  ,["UY","Uruguay"]
  ,["UZ","Uzbekistan"]
  ,["VA","Vatican"]
  ,["VC","Saint Vincent and the Grenadines"]
  ,["VE","Venezuela"]
  ,["VG","British Virgin Islands"]
  ,["VI","U.S. Virgin Islands"]
  ,["VN","Vietnam"]
  ,["VU","Vanuatu"]
  ,["WF","Wallis and Futuna"]
  ,["WS","Samoa"]
  ,["XK","Kosovo"]
  ,["YE","Yemen"]
  ,["YT","Mayotte"]
  ,["ZA","South Africa"]
  ,["ZM","Zambia"]
  ,["ZW","Zimbabwe"]
  ]

zone :: [[String]]
zone = 
  [["1","AD","Europe/Andorra"]
  ,["2","AE","Asia/Dubai"]
  ,["3","AF","Asia/Kabul"]
  ,["4","AG","America/Antigua"]
  ,["5","AI","America/Anguilla"]
  ,["6","AL","Europe/Tirane"]
  ,["7","AM","Asia/Yerevan"]
  ,["8","AO","Africa/Luanda"]
  ,["9","AQ","Antarctica/McMurdo"]
  ,["10","AQ","Antarctica/Rothera"]
  ,["11","AQ","Antarctica/Palmer"]
  ,["12","AQ","Antarctica/Mawson"]
  ,["13","AQ","Antarctica/Davis"]
  ,["14","AQ","Antarctica/Casey"]
  ,["15","AQ","Antarctica/Vostok"]
  ,["16","AQ","Antarctica/DumontDUrville"]
  ,["17","AQ","Antarctica/Syowa"]
  ,["18","AR","America/Argentina/Buenos_Aires"]
  ,["19","AR","America/Argentina/Cordoba"]
  ,["20","AR","America/Argentina/Salta"]
  ,["21","AR","America/Argentina/Jujuy"]
  ,["22","AR","America/Argentina/Tucuman"]
  ,["23","AR","America/Argentina/Catamarca"]
  ,["24","AR","America/Argentina/La_Rioja"]
  ,["25","AR","America/Argentina/San_Juan"]
  ,["26","AR","America/Argentina/Mendoza"]
  ,["27","AR","America/Argentina/San_Luis"]
  ,["28","AR","America/Argentina/Rio_Gallegos"]
  ,["29","AR","America/Argentina/Ushuaia"]
  ,["30","AS","Pacific/Pago_Pago"]
  ,["31","AT","Europe/Vienna"]
  ,["32","AU","Australia/Lord_Howe"]
  ,["33","AU","Antarctica/Macquarie"]
  ,["34","AU","Australia/Hobart"]
  ,["35","AU","Australia/Currie"]
  ,["36","AU","Australia/Melbourne"]
  ,["37","AU","Australia/Sydney"]
  ,["38","AU","Australia/Broken_Hill"]
  ,["39","AU","Australia/Brisbane"]
  ,["40","AU","Australia/Lindeman"]
  ,["41","AU","Australia/Adelaide"]
  ,["42","AU","Australia/Darwin"]
  ,["43","AU","Australia/Perth"]
  ,["44","AU","Australia/Eucla"]
  ,["45","AW","America/Aruba"]
  ,["46","AX","Europe/Mariehamn"]
  ,["47","AZ","Asia/Baku"]
  ,["48","BA","Europe/Sarajevo"]
  ,["49","BB","America/Barbados"]
  ,["50","BD","Asia/Dhaka"]
  ,["51","BE","Europe/Brussels"]
  ,["52","BF","Africa/Ouagadougou"]
  ,["53","BG","Europe/Sofia"]
  ,["54","BH","Asia/Bahrain"]
  ,["55","BI","Africa/Bujumbura"]
  ,["56","BJ","Africa/Porto-Novo"]
  ,["57","BL","America/St_Barthelemy"]
  ,["58","BM","Atlantic/Bermuda"]
  ,["59","BN","Asia/Brunei"]
  ,["60","BO","America/La_Paz"]
  ,["61","BQ","America/Kralendijk"]
  ,["62","BR","America/Noronha"]
  ,["63","BR","America/Belem"]
  ,["64","BR","America/Fortaleza"]
  ,["65","BR","America/Recife"]
  ,["66","BR","America/Araguaina"]
  ,["67","BR","America/Maceio"]
  ,["68","BR","America/Bahia"]
  ,["69","BR","America/Sao_Paulo"]
  ,["70","BR","America/Campo_Grande"]
  ,["71","BR","America/Cuiaba"]
  ,["72","BR","America/Santarem"]
  ,["73","BR","America/Porto_Velho"]
  ,["74","BR","America/Boa_Vista"]
  ,["75","BR","America/Manaus"]
  ,["76","BR","America/Eirunepe"]
  ,["77","BR","America/Rio_Branco"]
  ,["78","BS","America/Nassau"]
  ,["79","BT","Asia/Thimphu"]
  ,["80","BW","Africa/Gaborone"]
  ,["81","BY","Europe/Minsk"]
  ,["82","BZ","America/Belize"]
  ,["83","CA","America/St_Johns"]
  ,["84","CA","America/Halifax"]
  ,["85","CA","America/Glace_Bay"]
  ,["86","CA","America/Moncton"]
  ,["87","CA","America/Goose_Bay"]
  ,["88","CA","America/Blanc-Sablon"]
  ,["89","CA","America/Toronto"]
  ,["90","CA","America/Nipigon"]
  ,["91","CA","America/Thunder_Bay"]
  ,["92","CA","America/Iqaluit"]
  ,["93","CA","America/Pangnirtung"]
  ,["94","CA","America/Resolute"]
  ,["95","CA","America/Atikokan"]
  ,["96","CA","America/Rankin_Inlet"]
  ,["97","CA","America/Winnipeg"]
  ,["98","CA","America/Rainy_River"]
  ,["99","CA","America/Regina"]
  ,["100","CA","America/Swift_Current"]
  ,["101","CA","America/Edmonton"]
  ,["102","CA","America/Cambridge_Bay"]
  ,["103","CA","America/Yellowknife"]
  ,["104","CA","America/Inuvik"]
  ,["105","CA","America/Creston"]
  ,["106","CA","America/Dawson_Creek"]
  ,["107","CA","America/Vancouver"]
  ,["108","CA","America/Whitehorse"]
  ,["109","CA","America/Dawson"]
  ,["110","CC","Indian/Cocos"]
  ,["111","CD","Africa/Kinshasa"]
  ,["112","CD","Africa/Lubumbashi"]
  ,["113","CF","Africa/Bangui"]
  ,["114","CG","Africa/Brazzaville"]
  ,["115","CH","Europe/Zurich"]
  ,["116","CI","Africa/Abidjan"]
  ,["117","CK","Pacific/Rarotonga"]
  ,["118","CL","America/Santiago"]
  ,["119","CL","Pacific/Easter"]
  ,["120","CM","Africa/Douala"]
  ,["121","CN","Asia/Shanghai"]
  ,["122","CN","Asia/Harbin"]
  ,["123","CN","Asia/Chongqing"]
  ,["124","CN","Asia/Urumqi"]
  ,["125","CN","Asia/Kashgar"]
  ,["126","CO","America/Bogota"]
  ,["127","CR","America/Costa_Rica"]
  ,["128","CU","America/Havana"]
  ,["129","CV","Atlantic/Cape_Verde"]
  ,["130","CW","America/Curacao"]
  ,["131","CX","Indian/Christmas"]
  ,["132","CY","Asia/Nicosia"]
  ,["133","CZ","Europe/Prague"]
  ,["134","DE","Europe/Berlin"]
  ,["135","DE","Europe/Busingen"]
  ,["136","DJ","Africa/Djibouti"]
  ,["137","DK","Europe/Copenhagen"]
  ,["138","DM","America/Dominica"]
  ,["139","DO","America/Santo_Domingo"]
  ,["140","DZ","Africa/Algiers"]
  ,["141","EC","America/Guayaquil"]
  ,["142","EC","Pacific/Galapagos"]
  ,["143","EE","Europe/Tallinn"]
  ,["144","EG","Africa/Cairo"]
  ,["145","EH","Africa/El_Aaiun"]
  ,["146","ER","Africa/Asmara"]
  ,["147","ES","Europe/Madrid"]
  ,["148","ES","Africa/Ceuta"]
  ,["149","ES","Atlantic/Canary"]
  ,["150","ET","Africa/Addis_Ababa"]
  ,["151","FI","Europe/Helsinki"]
  ,["152","FJ","Pacific/Fiji"]
  ,["153","FK","Atlantic/Stanley"]
  ,["154","FM","Pacific/Chuuk"]
  ,["155","FM","Pacific/Pohnpei"]
  ,["156","FM","Pacific/Kosrae"]
  ,["157","FO","Atlantic/Faroe"]
  ,["158","FR","Europe/Paris"]
  ,["159","GA","Africa/Libreville"]
  ,["160","GB","Europe/London"]
  ,["161","GD","America/Grenada"]
  ,["162","GE","Asia/Tbilisi"]
  ,["163","GF","America/Cayenne"]
  ,["164","GG","Europe/Guernsey"]
  ,["165","GH","Africa/Accra"]
  ,["166","GI","Europe/Gibraltar"]
  ,["167","GL","America/Godthab"]
  ,["168","GL","America/Danmarkshavn"]
  ,["169","GL","America/Scoresbysund"]
  ,["170","GL","America/Thule"]
  ,["171","GM","Africa/Banjul"]
  ,["172","GN","Africa/Conakry"]
  ,["173","GP","America/Guadeloupe"]
  ,["174","GQ","Africa/Malabo"]
  ,["175","GR","Europe/Athens"]
  ,["176","GS","Atlantic/South_Georgia"]
  ,["177","GT","America/Guatemala"]
  ,["178","GU","Pacific/Guam"]
  ,["179","GW","Africa/Bissau"]
  ,["180","GY","America/Guyana"]
  ,["181","HK","Asia/Hong_Kong"]
  ,["182","HN","America/Tegucigalpa"]
  ,["183","HR","Europe/Zagreb"]
  ,["184","HT","America/Port-au-Prince"]
  ,["185","HU","Europe/Budapest"]
  ,["186","ID","Asia/Jakarta"]
  ,["187","ID","Asia/Pontianak"]
  ,["188","ID","Asia/Makassar"]
  ,["189","ID","Asia/Jayapura"]
  ,["190","IE","Europe/Dublin"]
  ,["191","IL","Asia/Jerusalem"]
  ,["192","IM","Europe/Isle_of_Man"]
  ,["193","IN","Asia/Kolkata"]
  ,["194","IO","Indian/Chagos"]
  ,["195","IQ","Asia/Baghdad"]
  ,["196","IR","Asia/Tehran"]
  ,["197","IS","Atlantic/Reykjavik"]
  ,["198","IT","Europe/Rome"]
  ,["199","JE","Europe/Jersey"]
  ,["200","JM","America/Jamaica"]
  ,["201","JO","Asia/Amman"]
  ,["202","JP","Asia/Tokyo"]
  ,["203","KE","Africa/Nairobi"]
  ,["204","KG","Asia/Bishkek"]
  ,["205","KH","Asia/Phnom_Penh"]
  ,["206","KI","Pacific/Tarawa"]
  ,["207","KI","Pacific/Enderbury"]
  ,["208","KI","Pacific/Kiritimati"]
  ,["209","KM","Indian/Comoro"]
  ,["210","KN","America/St_Kitts"]
  ,["211","KP","Asia/Pyongyang"]
  ,["212","KR","Asia/Seoul"]
  ,["213","KW","Asia/Kuwait"]
  ,["214","KY","America/Cayman"]
  ,["215","KZ","Asia/Almaty"]
  ,["216","KZ","Asia/Qyzylorda"]
  ,["217","KZ","Asia/Aqtobe"]
  ,["218","KZ","Asia/Aqtau"]
  ,["219","KZ","Asia/Oral"]
  ,["220","LA","Asia/Vientiane"]
  ,["221","LB","Asia/Beirut"]
  ,["222","LC","America/St_Lucia"]
  ,["223","LI","Europe/Vaduz"]
  ,["224","LK","Asia/Colombo"]
  ,["225","LR","Africa/Monrovia"]
  ,["226","LS","Africa/Maseru"]
  ,["227","LT","Europe/Vilnius"]
  ,["228","LU","Europe/Luxembourg"]
  ,["229","LV","Europe/Riga"]
  ,["230","LY","Africa/Tripoli"]
  ,["231","MA","Africa/Casablanca"]
  ,["232","MC","Europe/Monaco"]
  ,["233","MD","Europe/Chisinau"]
  ,["234","ME","Europe/Podgorica"]
  ,["235","MF","America/Marigot"]
  ,["236","MG","Indian/Antananarivo"]
  ,["237","MH","Pacific/Majuro"]
  ,["238","MH","Pacific/Kwajalein"]
  ,["239","MK","Europe/Skopje"]
  ,["240","ML","Africa/Bamako"]
  ,["241","MM","Asia/Rangoon"]
  ,["242","MN","Asia/Ulaanbaatar"]
  ,["243","MN","Asia/Hovd"]
  ,["244","MN","Asia/Choibalsan"]
  ,["245","MO","Asia/Macau"]
  ,["246","MP","Pacific/Saipan"]
  ,["247","MQ","America/Martinique"]
  ,["248","MR","Africa/Nouakchott"]
  ,["249","MS","America/Montserrat"]
  ,["250","MT","Europe/Malta"]
  ,["251","MU","Indian/Mauritius"]
  ,["252","MV","Indian/Maldives"]
  ,["253","MW","Africa/Blantyre"]
  ,["254","MX","America/Mexico_City"]
  ,["255","MX","America/Cancun"]
  ,["256","MX","America/Merida"]
  ,["257","MX","America/Monterrey"]
  ,["258","MX","America/Matamoros"]
  ,["259","MX","America/Mazatlan"]
  ,["260","MX","America/Chihuahua"]
  ,["261","MX","America/Ojinaga"]
  ,["262","MX","America/Hermosillo"]
  ,["263","MX","America/Tijuana"]
  ,["264","MX","America/Santa_Isabel"]
  ,["265","MX","America/Bahia_Banderas"]
  ,["266","MY","Asia/Kuala_Lumpur"]
  ,["267","MY","Asia/Kuching"]
  ,["268","MZ","Africa/Maputo"]
  ,["269","NA","Africa/Windhoek"]
  ,["270","NC","Pacific/Noumea"]
  ,["271","NE","Africa/Niamey"]
  ,["272","NF","Pacific/Norfolk"]
  ,["273","NG","Africa/Lagos"]
  ,["274","NI","America/Managua"]
  ,["275","NL","Europe/Amsterdam"]
  ,["276","NO","Europe/Oslo"]
  ,["277","NP","Asia/Kathmandu"]
  ,["278","NR","Pacific/Nauru"]
  ,["279","NU","Pacific/Niue"]
  ,["280","NZ","Pacific/Auckland"]
  ,["281","NZ","Pacific/Chatham"]
  ,["282","OM","Asia/Muscat"]
  ,["283","PA","America/Panama"]
  ,["284","PE","America/Lima"]
  ,["285","PF","Pacific/Tahiti"]
  ,["286","PF","Pacific/Marquesas"]
  ,["287","PF","Pacific/Gambier"]
  ,["288","PG","Pacific/Port_Moresby"]
  ,["289","PH","Asia/Manila"]
  ,["290","PK","Asia/Karachi"]
  ,["291","PL","Europe/Warsaw"]
  ,["292","PM","America/Miquelon"]
  ,["293","PN","Pacific/Pitcairn"]
  ,["294","PR","America/Puerto_Rico"]
  ,["295","PS","Asia/Gaza"]
  ,["296","PS","Asia/Hebron"]
  ,["297","PT","Europe/Lisbon"]
  ,["298","PT","Atlantic/Madeira"]
  ,["299","PT","Atlantic/Azores"]
  ,["300","PW","Pacific/Palau"]
  ,["301","PY","America/Asuncion"]
  ,["302","QA","Asia/Qatar"]
  ,["303","RE","Indian/Reunion"]
  ,["304","RO","Europe/Bucharest"]
  ,["305","RS","Europe/Belgrade"]
  ,["306","RU","Europe/Kaliningrad"]
  ,["307","RU","Europe/Moscow"]
  ,["308","RU","Europe/Volgograd"]
  ,["309","RU","Europe/Samara"]
  ,["310","RU","Asia/Yekaterinburg"]
  ,["311","RU","Asia/Omsk"]
  ,["312","RU","Asia/Novosibirsk"]
  ,["313","RU","Asia/Novokuznetsk"]
  ,["314","RU","Asia/Krasnoyarsk"]
  ,["315","RU","Asia/Irkutsk"]
  ,["316","RU","Asia/Yakutsk"]
  ,["317","RU","Asia/Khandyga"]
  ,["318","RU","Asia/Vladivostok"]
  ,["319","RU","Asia/Sakhalin"]
  ,["320","RU","Asia/Ust-Nera"]
  ,["321","RU","Asia/Magadan"]
  ,["322","RU","Asia/Kamchatka"]
  ,["323","RU","Asia/Anadyr"]
  ,["324","RW","Africa/Kigali"]
  ,["325","SA","Asia/Riyadh"]
  ,["326","SB","Pacific/Guadalcanal"]
  ,["327","SC","Indian/Mahe"]
  ,["328","SD","Africa/Khartoum"]
  ,["329","SE","Europe/Stockholm"]
  ,["330","SG","Asia/Singapore"]
  ,["331","SH","Atlantic/St_Helena"]
  ,["332","SI","Europe/Ljubljana"]
  ,["333","SJ","Arctic/Longyearbyen"]
  ,["334","SK","Europe/Bratislava"]
  ,["335","SL","Africa/Freetown"]
  ,["336","SM","Europe/San_Marino"]
  ,["337","SN","Africa/Dakar"]
  ,["338","SO","Africa/Mogadishu"]
  ,["339","SR","America/Paramaribo"]
  ,["340","SS","Africa/Juba"]
  ,["341","ST","Africa/Sao_Tome"]
  ,["342","SV","America/El_Salvador"]
  ,["343","SX","America/Lower_Princes"]
  ,["344","SY","Asia/Damascus"]
  ,["345","SZ","Africa/Mbabane"]
  ,["346","TC","America/Grand_Turk"]
  ,["347","TD","Africa/Ndjamena"]
  ,["348","TF","Indian/Kerguelen"]
  ,["349","TG","Africa/Lome"]
  ,["350","TH","Asia/Bangkok"]
  ,["351","TJ","Asia/Dushanbe"]
  ,["352","TK","Pacific/Fakaofo"]
  ,["353","TL","Asia/Dili"]
  ,["354","TM","Asia/Ashgabat"]
  ,["355","TN","Africa/Tunis"]
  ,["356","TO","Pacific/Tongatapu"]
  ,["357","TR","Europe/Istanbul"]
  ,["358","TT","America/Port_of_Spain"]
  ,["359","TV","Pacific/Funafuti"]
  ,["360","TW","Asia/Taipei"]
  ,["361","TZ","Africa/Dar_es_Salaam"]
  ,["362","UA","Europe/Kiev"]
  ,["363","UA","Europe/Uzhgorod"]
  ,["364","UA","Europe/Zaporozhye"]
  ,["365","UA","Europe/Simferopol"]
  ,["366","UG","Africa/Kampala"]
  ,["367","UM","Pacific/Johnston"]
  ,["368","UM","Pacific/Midway"]
  ,["369","UM","Pacific/Wake"]
  ,["370","US","America/New_York"]
  ,["371","US","America/Detroit"]
  ,["372","US","America/Kentucky/Louisville"]
  ,["373","US","America/Kentucky/Monticello"]
  ,["374","US","America/Indiana/Indianapolis"]
  ,["375","US","America/Indiana/Vincennes"]
  ,["376","US","America/Indiana/Winamac"]
  ,["377","US","America/Indiana/Marengo"]
  ,["378","US","America/Indiana/Petersburg"]
  ,["379","US","America/Indiana/Vevay"]
  ,["380","US","America/Chicago"]
  ,["381","US","America/Indiana/Tell_City"]
  ,["382","US","America/Indiana/Knox"]
  ,["383","US","America/Menominee"]
  ,["384","US","America/North_Dakota/Center"]
  ,["385","US","America/North_Dakota/New_Salem"]
  ,["386","US","America/North_Dakota/Beulah"]
  ,["387","US","America/Denver"]
  ,["388","US","America/Boise"]
  ,["389","US","America/Phoenix"]
  ,["390","US","America/Los_Angeles"]
  ,["391","US","America/Anchorage"]
  ,["392","US","America/Juneau"]
  ,["393","US","America/Sitka"]
  ,["394","US","America/Yakutat"]
  ,["395","US","America/Nome"]
  ,["396","US","America/Adak"]
  ,["397","US","America/Metlakatla"]
  ,["398","US","Pacific/Honolulu"]
  ,["399","UY","America/Montevideo"]
  ,["400","UZ","Asia/Samarkand"]
  ,["401","UZ","Asia/Tashkent"]
  ,["402","VA","Europe/Vatican"]
  ,["403","VC","America/St_Vincent"]
  ,["404","VE","America/Caracas"]
  ,["405","VG","America/Tortola"]
  ,["406","VI","America/St_Thomas"]
  ,["407","VN","Asia/Ho_Chi_Minh"]
  ,["408","VU","Pacific/Efate"]
  ,["409","WF","Pacific/Wallis"]
  ,["410","WS","Pacific/Apia"]
  ,["411","YE","Asia/Aden"]
  ,["412","YT","Indian/Mayotte"]
  ,["413","ZA","Africa/Johannesburg"]
  ,["414","ZM","Africa/Lusaka"]
  ,["415","ZW","Africa/Harare"]
  ]

zonetime :: [[String]]
zonetime = 
  [["36","EST","-2147483648","36000","0"]
  ,["36","EST","-2147397248","36000","0"]
  ,["36","EST","-1672567140","39600","1"]
  ,["36","EST","-1665392400","36000","0"]
  ,["36","EST","-883641600","39600","1"]
  ,["36","EST","-876128400","36000","0"]
  ,["36","EST","-860400000","39600","1"]
  ,["36","EST","-844678800","36000","0"]
  ,["36","EST","-828345600","39600","1"]
  ,["36","EST","-813229200","36000","0"]
  ,["36","EST","57686400","39600","1"]
  ,["36","EST","67968000","36000","0"]
  ,["36","EST","89136000","39600","1"]
  ,["36","EST","100022400","36000","0"]
  ,["36","EST","120585600","39600","1"]
  ,["36","EST","131472000","36000","0"]
  ,["36","EST","152035200","39600","1"]
  ,["36","EST","162921600","36000","0"]
  ,["36","EST","183484800","39600","1"]
  ,["36","EST","194976000","36000","0"]
  ,["36","EST","215539200","39600","1"]
  ,["36","EST","226425600","36000","0"]
  ,["36","EST","246988800","39600","1"]
  ,["36","EST","257875200","36000","0"]
  ,["36","EST","278438400","39600","1"]
  ,["36","EST","289324800","36000","0"]
  ,["36","EST","309888000","39600","1"]
  ,["36","EST","320774400","36000","0"]
  ,["36","EST","341337600","39600","1"]
  ,["36","EST","352224000","36000","0"]
  ,["36","EST","372787200","39600","1"]
  ,["36","EST","384278400","36000","0"]
  ,["36","EST","404841600","39600","1"]
  ,["36","EST","415728000","36000","0"]
  ,["36","EST","436291200","39600","1"]
  ,["36","EST","447177600","36000","0"]
  ,["36","EST","467740800","39600","1"]
  ,["36","EST","478627200","36000","0"]
  ,["36","EST","499190400","39600","1"]
  ,["36","EST","511286400","36000","0"]
  ,["36","EST","530035200","39600","1"]
  ,["36","EST","542736000","36000","0"]
  ,["36","EST","561484800","39600","1"]
  ,["36","EST","574790400","36000","0"]
  ,["36","EST","594144000","39600","1"]
  ,["36","EST","606240000","36000","0"]
  ,["36","EST","625593600","39600","1"]
  ,["36","EST","637689600","36000","0"]
  ,["36","EST","657043200","39600","1"]
  ,["36","EST","667929600","36000","0"]
  ,["36","EST","688492800","39600","1"]
  ,["36","EST","699379200","36000","0"]
  ,["36","EST","719942400","39600","1"]
  ,["36","EST","731433600","36000","0"]
  ,["36","EST","751996800","39600","1"]
  ,["36","EST","762883200","36000","0"]
  ,["36","EST","783446400","39600","1"]
  ,["36","EST","796147200","36000","0"]
  ,["36","EST","814896000","39600","1"]
  ,["36","EST","828201600","36000","0"]
  ,["36","EST","846345600","39600","1"]
  ,["36","EST","859651200","36000","0"]
  ,["36","EST","877795200","39600","1"]
  ,["36","EST","891100800","36000","0"]
  ,["36","EST","909244800","39600","1"]
  ,["36","EST","922550400","36000","0"]
  ,["36","EST","941299200","39600","1"]
  ,["36","EST","954000000","36000","0"]
  ,["36","EST","967305600","39600","1"]
  ,["36","EST","985449600","36000","0"]
  ,["36","EST","1004198400","39600","1"]
  ,["36","EST","1017504000","36000","0"]
  ,["36","EST","1035648000","39600","1"]
  ,["36","EST","1048953600","36000","0"]
  ,["36","EST","1067097600","39600","1"]
  ,["36","EST","1080403200","36000","0"]
  ,["36","EST","1099152000","39600","1"]
  ,["36","EST","1111852800","36000","0"]
  ,["36","EST","1130601600","39600","1"]
  ,["36","EST","1143907200","36000","0"]
  ,["36","EST","1162051200","39600","1"]
  ,["36","EST","1174752000","36000","0"]
  ,["36","EST","1193500800","39600","1"]
  ,["36","EST","1207411200","36000","0"]
  ,["36","EST","1223136000","39600","1"]
  ,["36","EST","1238860800","36000","0"]
  ,["36","EST","1254585600","39600","1"]
  ,["36","EST","1270310400","36000","0"]
  ,["36","EST","1286035200","39600","1"]
  ,["36","EST","1301760000","36000","0"]
  ,["36","EST","1317484800","39600","1"]
  ,["36","EST","1333209600","36000","0"]
  ,["36","EST","1349539200","39600","1"]
  ,["36","EST","1365264000","36000","0"]
  ,["36","EST","1380988800","39600","1"]
  ,["36","EST","1396713600","36000","0"]
  ,["36","EST","1412438400","39600","1"]
  ,["36","EST","1428163200","36000","0"]
  ,["36","EST","1443888000","39600","1"]
  ,["36","EST","1459612800","36000","0"]
  ,["36","EST","1475337600","39600","1"]
  ,["36","EST","1491062400","36000","0"]
  ,["36","EST","1506787200","39600","1"]
  ,["36","EST","1522512000","36000","0"]
  ,["36","EST","1538841600","39600","1"]
  ,["36","EST","1554566400","36000","0"]
  ,["36","EST","1570291200","39600","1"]
  ,["36","EST","1586016000","36000","0"]
  ,["36","EST","1601740800","39600","1"]
  ,["36","EST","1617465600","36000","0"]
  ,["36","EST","1633190400","39600","1"]
  ,["36","EST","1648915200","36000","0"]
  ,["36","EST","1664640000","39600","1"]
  ,["36","EST","1680364800","36000","0"]
  ,["36","EST","1696089600","39600","1"]
  ,["36","EST","1712419200","36000","0"]
  ,["36","EST","1728144000","39600","1"]
  ,["36","EST","1743868800","36000","0"]
  ,["36","EST","1759593600","39600","1"]
  ,["36","EST","1775318400","36000","0"]
  ,["36","EST","1791043200","39600","1"]
  ,["36","EST","1806768000","36000","0"]
  ,["36","EST","1822492800","39600","1"]
  ,["36","EST","1838217600","36000","0"]
  ,["36","EST","1853942400","39600","1"]
  ,["36","EST","1869667200","36000","0"]
  ,["36","EST","1885996800","39600","1"]
  ,["36","EST","1901721600","36000","0"]
  ,["36","EST","1917446400","39600","1"]
  ,["36","EST","1933171200","36000","0"]
  ,["36","EST","1948896000","39600","1"]
  ,["36","EST","1964620800","36000","0"]
  ,["36","EST","1980345600","39600","1"]
  ,["36","EST","1996070400","36000","0"]
  ,["36","EST","2011795200","39600","1"]
  ,["36","EST","2027520000","36000","0"]
  ,["36","EST","2043244800","39600","1"]
  ,["36","EST","2058969600","36000","0"]
  ,["36","EST","2075299200","39600","1"]
  ,["36","EST","2091024000","36000","0"]
  ,["36","EST","2106748800","39600","1"]
  ,["36","EST","2122473600","36000","0"]
  ,["36","EST","2138198400","39600","1"]
  ,["36","EST","2147397247","39600","1"]
  ,["36","EST","2147483647","39600","1"]
  ,["39","EST","-2147483648","36000","0"]
  ,["39","EST","-2147397248","36000","0"]
  ,["39","EST","-1672567140","39600","1"]
  ,["39","EST","-1665392400","36000","0"]
  ,["39","EST","-883641600","39600","1"]
  ,["39","EST","-876128400","36000","0"]
  ,["39","EST","-860400000","39600","1"]
  ,["39","EST","-844678800","36000","0"]
  ,["39","EST","-828345600","39600","1"]
  ,["39","EST","-813229200","36000","0"]
  ,["39","EST","57686400","39600","1"]
  ,["39","EST","67968000","36000","0"]
  ,["39","EST","625593600","39600","1"]
  ,["39","EST","636480000","36000","0"]
  ,["39","EST","657043200","39600","1"]
  ,["39","EST","667929600","36000","0"]
  ,["39","EST","688492800","39600","1"]
  ,["39","EST","699379200","36000","0"]
  ,["39","EST","2147397247","36000","0"]
  ,["39","EST","2147483647","36000","0"]
  ]




  
